<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Report - {{ user.username }}</title>
    <style>
        @page {
            size: A4;
            margin: 1.5cm;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', 'Helvetica', sans-serif;
            font-size: 11pt;
            line-height: 1.6;
            color: #333;
        }
        
        .header {
            background: linear-gradient(135deg, #21808d 0%, #1d6b75 100%);
            color: white;
            padding: 30px;
            text-align: center;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 28pt;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 11pt;
            opacity: 0.9;
        }
        
        .info-box {
            background: #f8f9fa;
            padding: 15px;
            border-left: 4px solid #21808d;
            margin-bottom: 20px;
            border-radius: 4px;
        }
        
        .info-box h3 {
            color: #21808d;
            font-size: 14pt;
            margin-bottom: 10px;
        }
        
        .section {
            margin-bottom: 30px;
            page-break-inside: avoid;
        }
        
        .section-title {
            background: #21808d;
            color: white;
            padding: 12px 15px;
            font-size: 14pt;
            font-weight: bold;
            border-radius: 4px;
            margin-bottom: 15px;
        }
        
        .section-content {
            padding: 0 10px;
        }
        
        ul {
            list-style: none;
            padding: 0;
        }
        
        ul li {
            padding: 8px 0 8px 25px;
            position: relative;
            border-bottom: 1px solid #eee;
        }
        
        ul li:last-child {
            border-bottom: none;
        }
        
        ul li:before {
            position: absolute;
            left: 0;
            font-weight: bold;
            font-size: 12pt;
        }
        
        .analysis-list li:before {
            content: "üìå";
        }
        
        .eat-list li:before {
            content: "‚úÖ";
        }
        
        .avoid-list li:before {
            content: "‚ùå";
        }
        
        .habits-list li:before {
            content: "üí°";
        }
        
        .allergy-section {
            background: #fff3cd;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }
        
        .allergy-section h3 {
            color: #92400e;
            margin-bottom: 10px;
        }
        
        .allergy-badge {
            display: inline-block;
            background: #fde68a;
            color: #92400e;
            padding: 5px 12px;
            margin: 3px;
            border-radius: 15px;
            font-size: 9pt;
            font-weight: 600;
        }
        
        .two-column {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .two-column .column {
            flex: 1;
        }
        
        .disclaimer {
            background: #f1f5f9;
            border-left: 4px solid #21808d;
            padding: 15px;
            margin-top: 30px;
            font-size: 9pt;
            border-radius: 4px;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #ddd;
            font-size: 9pt;
            color: #666;
        }
        
        strong {
            color: #1e293b;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>ü©∫ Blood Health Report</h1>
        <p>AI-Powered Health Analysis & Recommendations</p>
        <p style="margin-top: 10px;">
            <strong>Patient:</strong> {{ user.username }} | 
            <strong>Report Date:</strong> {{ blood_report.uploaded_at|date:"F d, Y" }}
        </p>
    </div>

    <!-- Patient Info -->
    <div class="info-box">
        <h3>üìã Report Information</h3>
        <p><strong>Report ID:</strong> #{{ blood_report.id }}</p>
        <p><strong>Generated:</strong> {{ generated_date|date:"F d, Y - h:i A" }}</p>
        <p><strong>Patient:</strong> {{ user.username }}</p>
    </div>

    <!-- Allergy Information -->
    {% if user_allergies or common_allergies %}
    <div class="allergy-section">
        <h3>‚ö†Ô∏è Allergy Profile</h3>
        <p style="margin-bottom: 10px;"><strong>All recommendations consider these allergies:</strong></p>
        
        {% if user_allergies %}
            <p><strong>Specific Allergies:</strong> {{ user_allergies }}</p>
        {% endif %}
        
        {% if common_allergies %}
            <p><strong>Common Allergens:</strong></p>
            <div>
                {% for allergy in common_allergies %}
                    <span class="allergy-badge">{{ allergy }}</span>
                {% endfor %}
            </div>
        {% endif %}
    </div>
    {% endif %}

    <!-- Detailed Analysis -->
    <div class="section">
        <div class="section-title">üìä Key Findings from Blood Report</div>
        <div class="section-content">
            <ul class="analysis-list">
                {% for point in analysis_points %}
                    <li>{{ point }}</li>
                {% endfor %}
            </ul>
        </div>
    </div>

    <!-- Foods Section (Two Columns) -->
    <div class="two-column">
        <!-- Foods to Eat -->
        <div class="column">
            <div class="section">
                <div class="section-title" style="background: #10b981;">‚úÖ Foods to Include</div>
                <div class="section-content">
                    <ul class="eat-list">
                        {% for food in foods_to_eat %}
                            <li>{{ food }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>

        <!-- Foods to Avoid -->
        <div class="column">
            <div class="section">
                <div class="section-title" style="background: #ef4444;">‚ùå Foods to Avoid</div>
                <div class="section-content">
                    <ul class="avoid-list">
                        {% for food in foods_to_avoid %}
                            <li>{{ food }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Daily Habits -->
    <div class="section">
        <div class="section-title" style="background: #f59e0b;">üí™ Daily Habits & Lifestyle Tips</div>
        <div class="section-content">
            <ul class="habits-list">
                {% for habit in daily_habits %}
                    <li>{{ habit }}</li>
                {% endfor %}
            </ul>
        </div>
    </div>

    <!-- Disclaimer -->
    <div class="disclaimer">
        <strong>‚öïÔ∏è Medical Disclaimer:</strong>
        These recommendations are AI-generated suggestions based on your blood report analysis. 
        They are intended for informational purposes only and do not constitute medical advice. 
        Please consult with your healthcare provider before making any significant changes to your 
        diet, exercise routine, or lifestyle.
    </div>

    <!-- Footer -->
    <div class="footer">
        <p><strong>Blood Health Advisor</strong> | Powered by Google Gemini AI</p>
        <p>Generated on {{ generated_date|date:"F d, Y at h:i A" }}</p>
        <p style="margin-top: 10px; font-size: 8pt;">
            This report is confidential and intended solely for the patient named above.
        </p>
    </div>
</body>
</html>
